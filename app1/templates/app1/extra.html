Ansar Ahmed
ULTIMATE DESIGN TECHNOLOGY LLP
EE
1173919287
1173919287
Mumbai
ansar@mail.com

make parameter dynamic


*********************

this code filter data from current page if i filter next page data then it not filter correctly 
so i wanted to filter data from all pages not only in current page

this is model "class UserEnrolled(models.Model):
sr = models.AutoField(primary_key=True, unique=True)
picture = models.ImageField(upload_to='user_pictures/', blank=True, null=True)
name = models.CharField(max_length=255)
company_name = models.CharField(max_length=100)
job_role = models.CharField(max_length=100)
mycompany_id = models.CharField(max_length=10)
tag_id = models.CharField(max_length=50)
job_location = models.CharField(max_length=100)
orientation = models.FileField(upload_to='attachments/', blank=True, null=True, validators=[FileExtensionValidator(['jpeg', 'jpg'])])
facial_data = models.ImageField(upload_to=user_image_upload_path, blank=True, null=True, verbose_name='Facial Data')
my_comply = models.ImageField(upload_to='compliance_images/', blank=True, null=True)
expiry_date = models.DateField(blank=True, null=True)
status = models.CharField(max_length=100, choices=[
    ('active', 'Active'),
    ('inactive', 'Inactive'),
    ('pending', 'Pending'),
], default='pending')
email = models.EmailField()
password = models.CharField(max_length=50)
site = models.ForeignKey('Site', on_delete=models.CASCADE, blank=True, null=True)

def _str_(self):
    return self.name

def get_folder_name(self):
    return self.name

def set_password(self, raw_password):
    self.password = make_password(raw_password)

def check_password(self, raw_password):
    return check_password(raw_password, self.password)"

this is get view "class get_data(ListView):
model = UserEnrolled
template_name = 'app1/getdata.html'
context_object_name = 'data'
paginate_by = 3

def get_queryset(self):
    queryset = UserEnrolled.objects.all()
    site_name = self.request.GET.get('site_name') or self.request.session.get('site_name')

    # Filter by site name if provided
    if site_name:
        queryset = queryset.filter(site__name=site_name)
    return queryset

def get_context_data(self, **kwargs):
    context = super().get_context_data(**kwargs)
    site_name = self.request.GET.get('site_name') or self.request.session.get('site_name')
    if site_name:
        self.request.session['site_name'] = site_name  # Save site_name to session
    context['site_name'] = site_name

    page = self.request.GET.get('page')
    paginator = Paginator(self.get_queryset(), self.paginate_by)
    page_obj = paginator.get_page(page)
    offset = self.paginate_by * (page_obj.number - 1)
    context['offset'] = offset
    context['page_obj'] = page_obj
    context['paginator'] = paginator
    
    context['data'] = list(enumerate(page_obj.object_list, start=offset + 1))
    sites = Site.objects.all()
    site_names = [(site.name, site.name) for site in sites]
    context['site_names'] = site_names
    return context
"
this is html code "<div class="filter-container">
    <label for="filterName">Name:</label>
    <input type="text" id="filterName" name="filterName" value="{{ request.GET.filterName|default_if_none:'' }}">

    <label for="filterCompanyName">Company Name:</label>
    <input type="text" id="filterCompanyName" name="filterCompanyName" value="{{ request.GET.filterCompanyName|default_if_none:'' }}">

    <label for="filterJobRole">Job Role:</label>
    <input type="text" id="filterJobRole" name="filterJobRole" value="{{ request.GET.filterJobRole|default_if_none:'' }}">

    <label for="filterJobLocation">Job Location:</label>
    <input type="text" id="filterJobLocation" name="filterJobLocation" value="{{ request.GET.filterJobLocation|default_if_none:'' }}">

    <label for="filterStatus">Status:</label>
    <select id="filterStatus" name="filterStatus">
        <option value="">All</option>
        <option value="active" {% if request.GET.filterStatus == 'active' %}selected{% endif %}>Active</option>
        <option value="inactive" {% if request.GET.filterStatus == 'inactive' %}selected{% endif %}>Inactive</option>
        <option value="pending" {% if request.GET.filterStatus == 'pending' %}selected{% endif %}>Pending</option>
    </select>
</div>

<table id="customers">
    <tr>
        <th><input type="checkbox" onClick="toggleAll(this)"></th>
        <th class="sortable">Sr No</th>
    <th>Picture</th>
    <th class="sortable">Name</th>
    <th class="sortable">Company</th>
    <th class="sortable">Job</th>
    <th class="sortable">MC ID</th>
    <th class="sortable">Tag ID</th>
    <th class="sortable">Location</th>
    <th>Email</th>
    <th>Orientation</th>
    <th>Facial Data</th>
    <th>SST</th>
    <th class="sortable">Expiry Data</th>
    <th class="sortable">Status</th>
    <th>Action</th>
    </tr>

    {% for index,i in data %}
    <tr>
        <td><input type="checkbox" name="selected_recordings" value="{{ i.pk }}"></td>
        
        <td>{{index}}</td>
        <td>
            {% if i.picture %}
            <img src="{{ i.picture.url }}" alt="user" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
            {% else %}
            <img src="{% static 'app1/images/img1.jpg' %}" alt="user" style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
            {% endif %}
        </td>
        
        
        <td><a href="{% url 'user_update' i.sr %}"style="text-decoration: none;">{{ i.name }}</a></td>
        <td>{{i.company_name}}</td>
        <td>{{i.job_role}}</td>
        <td>{{i.mycompany_id}}</td>
        <td>{{i.tag_id}}</td>
        <td>{{i.job_location}}</td>
        <td>{{i.email}}</td>
        {% load custom_filters %}
        <td>
            {% if i.orientation %}
            {% with file_extension=i.orientation.name|lower %}
            <a href="{{ i.orientation.url }}" target="_blank">
                <i class="file-icon {% if file_extension|slice:"-4" == '.pdf' %}far fa-file-pdf
                            {% elif file_extension|slice:"-4" == '.doc' or file_extension|slice:"-5" == '.docx' %}far fa-file-word
                            {% elif file_extension|slice:"-5" == '.jpeg' or file_extension|slice:"-4" == '.jpg' or file_extension|slice:"-4" == '.png' %}far fa-file-image
                            {% elif file_extension|slice:"-4" == '.xls' or file_extension|slice:"-5" == '.xlsx' %}far fa-file-excel
                            {% elif file_extension|slice:"-4" == '.ppt' or file_extension|slice:"-5" == '.pptx' %}far fa-file-powerpoint
                            {% else %}far fa-file
                        {% endif %}"></i>
            </a>
            {% endwith %}
            {% else %}
            N/A
            {% endif %}
        </td>
        {% load custom_filters %}
        <td>
            {% with file_extension=i.facial_data.name|lower %}
            <a href="{% url 'show_facial_data_images' i.pk %}" target="_blank">
                <i class="far fa-file-image
                    {% if file_extension|slice:"-4" == '.pdf' %}far fa-file-pdf
                    {% elif file_extension|slice:"-4" == '.doc' or file_extension|slice:"-5" == '.docx' %}far fa-file-word
                    {% elif file_extension|slice:"-5" == '.jpeg' or file_extension|slice:"-4" == '.jpg' or file_extension|slice:"-4" == '.png' %}far fa-file-image
                    {% elif file_extension|slice:"-4" == '.xls' or file_extension|slice:"-5" == '.xlsx' %}far fa-file-excel
                    {% elif file_extension|slice:"-4" == '.ppt' or file_extension|slice:"-5" == '.pptx' %}far fa-file-powerpoint
                    {% else %}far fa-file
                    {% endif %}
                "></i>
            </a>
            {% endwith %}
        </td>
        <td>
            {% if i.my_comply %}
            {% with file_extension=i.my_comply.name|lower %}
            <a href="{{ i.my_comply.url }}" target="_blank">
                <i class="file-icon {% if file_extension|slice:"-4" == '.pdf' %}far fa-file-pdf
                            {% elif file_extension|slice:"-4" == '.doc' or file_extension|slice:"-5" == '.docx' %}far fa-file-word
                            {% elif file_extension|slice:"-5" == '.jpeg' or file_extension|slice:"-4" == '.jpg' or file_extension|slice:"-4" == '.png' %}far fa-file-image
                            {% elif file_extension|slice:"-4" == '.xls' or file_extension|slice:"-5" == '.xlsx' %}far fa-file-excel
                            {% elif file_extension|slice:"-4" == '.ppt' or file_extension|slice:"-5" == '.pptx' %}far fa-file-powerpoint
                            {% else %}far fa-file
                        {% endif %}"></i>
            </a>
            {% endwith %}
            {% else %}
            N/A
            {% endif %}
        </td>
        <td>{{ i.expiry_date }}</td>
        <td>{{i.status}}</td>
        <td>
            <div class="dropdownb">
                <button class="btn-icon toggle-btn"><i class="fas fa-ellipsis-h"></i></button>
                <div class="dropdown-contentb">
                    <a href="{% url 'user_update' i.sr %}" class="edit-btn">Edit</a>
                    <a href="{% url 'task_delete' i.pk %}" class="delete-btn">Delete</a>
                </div>
            </div>
        </td>
        
    </tr>
    {% endfor %}
</table>

<div class="pagination">
    <span class="step-links">
        {% if page_obj.has_previous %}
            <a href="?page=1">&laquo; first</a>
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
            <a href="?page={{ paginator.num_pages }}">last &raquo;</a>
        {% endif %}
    </span>
</div>
"
this is js code "<script>
    // This function will be used to filter the data
    function filterData() {
        var filterName = document.getElementById('filterName').value.toLowerCase();
        var filterCompanyName = document.getElementById('filterCompanyName').value.toLowerCase();
        var filterJobRole = document.getElementById('filterJobRole').value.toLowerCase();
        var filterJobLocation = document.getElementById('filterJobLocation').value.toLowerCase();
        var filterStatus = document.getElementById('filterStatus').value.toLowerCase();

        var dataTable = document.getElementById('customers'); // Make sure the ID matches the table ID in your HTML
        var rows = dataTable.getElementsByTagName('tr');

        for (var i = 1; i < rows.length; i++) { // Start from 1 to skip the header row
            // Adjust the indices to match the correct columns in your HTML table
            var name = rows[i].getElementsByTagName('td')[3].textContent || rows[i].getElementsByTagName('td')[3].innerText;
            var companyName = rows[i].getElementsByTagName('td')[4].textContent || rows[i].getElementsByTagName('td')[4].innerText;
            var jobRole = rows[i].getElementsByTagName('td')[5].textContent || rows[i].getElementsByTagName('td')[5].innerText;
            var jobLocation = rows[i].getElementsByTagName('td')[8].textContent || rows[i].getElementsByTagName('td')[8].innerText;
            var status = rows[i].getElementsByTagName('td')[14].textContent || rows[i].getElementsByTagName('td')[14].innerText;

            if (name.toLowerCase().indexOf(filterName) !== -1 &&
                companyName.toLowerCase().indexOf(filterCompanyName) !== -1 &&
                jobRole.toLowerCase().indexOf(filterJobRole) !== -1 &&
                jobLocation.toLowerCase().indexOf(filterJobLocation) !== -1 &&
                (filterStatus === '' || status.toLowerCase().indexOf(filterStatus) !== -1)) {
                rows[i].style.display = '';
            } else {
                rows[i].style.display = 'none';
            }
        }
    }

    // Add event listeners to the filter inputs
    document.getElementById('filterName').addEventListener('keyup', filterData);
    document.getElementById('filterCompanyName').addEventListener('keyup', filterData);
    document.getElementById('filterJobRole').addEventListener('keyup', filterData);
    document.getElementById('filterJobLocation').addEventListener('keyup', filterData);
    document.getElementById('filterStatus').addEventListener('change', filterData);
</script>"

*********************


